close all;
data = readmatrix('r600A.xlsx');
% Extract the relevant columns
T_sat = data(:,1);      % Temperature (°C)
s_f   = data(:,3);      % Liquid entropy (kJ/kg·K)
s_g   = data(:,4);      % Vapor entropy (kJ/kg·K)

% Plot T–s saturation curves
hold on; grid on;
plot(s_f, T_sat, 'b-', 'LineWidth',1.5);
plot(s_g, T_sat, 'b-', 'LineWidth',1.5);

% Your loop points (closed by repeating the first at the end)
x = [2.3, 2.65, 2.345, 1.525, 1.7, 2.3];
y = [ 16, 130,   65,   65,   16, 16];

% 1) Plot straight lines for all segments except index 2→3
segments = [1 2; 3 4; 4 5; 5 6];
for i = 1:size(segments,1)
    i1 = segments(i,1);
    i2 = segments(i,2);
    plot( x([i1 i2]), y([i1 i2]), '-or', ...
          'LineWidth',1.5, 'MarkerFaceColor','r', ...
          'MarkerIndices',[1 2] );
end

% 2) Now insert a curved Bézier between point 2 and point 3
P2 = [x(2), y(2)];
P3 = [x(3), y(3)];
v  = P3 - P2;
n  = [-v(2), v(1)];  n = n/norm(n);
ctrl = (P2+P3)/2 + 0.05*n;  % adjust 0.1 for more/less bow

t = linspace(0,1,100)';
Bx = (1-t).^2*P2(1) + 2*(1-t).*t*ctrl(1) + t.^2*P3(1);
By = (1-t).^2*P2(2) + 2*(1-t).*t*ctrl(2) + t.^2*P3(2);

plot(Bx, By, 'r', ...
     'LineWidth',1.5, 'MarkerFaceColor','r', ...
     'MarkerIndices',[1 50 100]);

% 3) Annotate the *five* original points (1→5), shifting labels left by dx
dx = 0.05;
for k = 1:5
    if k == 3
        continue
    end 
    if k > 3
        text( x(k)-dx, y(k), sprintf('%d',k-1), ...
          'FontSize',18, 'FontWeight','bold', ...
          'VerticalAlignment','bottom', ...
          'HorizontalAlignment','right' );

    else
    text( x(k)-dx, y(k), sprintf('%d',k), ...
          'FontSize',18, 'FontWeight','bold', ...
          'VerticalAlignment','bottom', ...
          'HorizontalAlignment','right' );
    end
end


% Create axes
xlabel('s (kJ/(kg\cdotK))');
ylabel('T (^\circC)');
%title('R600a Saturation T–s Diagram');
set(gca, 'FontName','Times','FontSize',24,'FontWeight','bold');
set(gcf, 'Position', [100, 100, 700, 700]); 
% %legend('sat. liquid','sat. vapor','straight segs','curved 2→3','Location','SouthEast');
% Create text
% axes1 = axes();
% text('Parent',axes1,'VerticalAlignment','bottom',...
%     'HorizontalAlignment','right',...
%     'FontWeight','bold',...
%     'FontSize',18,...
%     'String','1',...
%     'Position',[2.35161290322581 15.1002570694087 1.4210854715202e-14]);
% 
% % Create text
% text('Parent',axes1,'VerticalAlignment','bottom',...
%     'HorizontalAlignment','right',...
%     'FontWeight','bold',...
%     'FontSize',18,...
%     'String','2',...
%     'Position',[2.61814516129032 128.380462724936 1.4210854715202e-14]);
% 
% % Create text
% text('Parent',axes1,'VerticalAlignment','bottom',...
%     'HorizontalAlignment','right',...
%     'FontWeight','bold',...
%     'FontSize',18,...
%     'String','3',...
%     'Position',[1.5125 64.4601542416452 1.4210854715202e-14]);
% 
% % Create text
% text('Parent',axes1,'VerticalAlignment','bottom',...
%     'HorizontalAlignment','right',...
%     'FontWeight','bold',...
%     'FontSize',18,...
%     'String','4',...
%     'Position',[1.65846774193548 13.3007712082262 1.4210854715202e-14]);
% % 
% % Create ylabel
% ylabel('T (^\circC)','FontWeight','bold','FontName','Times');
% 
% % Create xlabel
% xlabel('s (kJ/(kg\cdotK))','FontWeight','bold','FontName','Times');
% 
% grid(axes1,'on');
% hold(axes1,'off');
% % Set the remaining axes properties
% set(axes1,'FontName','Times','FontSize',24,'FontWeight','bold');
% % Create arrow
% annotation(figure1,'arrow',[0.498 0.498],[0.444 0.545],'LineWidth',2);
% 
% % Create arrow
% annotation(figure1,'arrow',[0.496 0.496],[0.149 0.25],'LineWidth',2);
% 
% % Create textbox
% annotation(figure1,'textbox',...
%     [0.356000000000001 0.7475 0.422000000000001 0.1775],...
%     'String',{'R600a','saturation','curve'},...
%     'FontSize',26,...
%     'FitBoxToText','off',...
%     'EdgeColor',[1 1 1]);
% 
% % Create textbox
% annotation(figure1,'textbox',...
%     [0.441479166666668 0.102676701570682 0.0481041666666654 0.1775],...
%     'String','Q_{eva}',...
%     'FontSize',26,...
%     'FitBoxToText','off',...
%     'EdgeColor',[1 1 1]);
% 
% % Create textbox
% annotation(figure1,'textbox',...
%     [0.553608796296302 0.495287958115183 0.145870370370364 0.0700850785340479],...
%     'String','P_2 = P_3 =9.7 bar',...
%     'FontSize',26,...
%     'FitBoxToText','off',...
%     'EdgeColor',[1 1 1]);
% 
% % Create textbox
% annotation(figure1,'textbox',...
%     [0.539025462962968 0.250261780104712 0.144828703703699 0.06484947643981],...
%     'String','P_2 = P_3 =2.2 bar',...
%     'FontSize',26,...
%     'FitBoxToText','off',...
%     'EdgeColor',[1 1 1]);
% 
% % Create textbox
% annotation(figure1,'textbox',...
%     [0.443083333333334 0.502617801047121 0.0569166666666655 0.0712434554973864],...
%     'String','Q_{con}',...
%     'FontSize',26,...
%     'FitBoxToText','off',...
%     'EdgeColor',[1 1 1]);



